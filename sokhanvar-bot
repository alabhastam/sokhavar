{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/aabdollahii/sokhanvar-pt2?scriptVersionId=278442837\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"a0684aa5","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:30.145476Z","iopub.status.busy":"2025-11-15T19:57:30.145161Z","iopub.status.idle":"2025-11-15T19:57:32.482426Z","shell.execute_reply":"2025-11-15T19:57:32.481297Z"},"papermill":{"duration":2.343823,"end_time":"2025-11-15T19:57:32.483999","exception":false,"start_time":"2025-11-15T19:57:30.140176","status":"completed"},"tags":[]},"outputs":[],"source":["import pandas as pd\n","import os\n","\n","\n","molana_file_path = '/kaggle/input/molana-poems-csv/.csv' # <-- CHECK THIS FILENAME\n","saadi_file_path = '/kaggle/input/saadi-poems-csv/(1).csv'\n","\n","molana_df = pd.read_csv(molana_file_path)\n","saadi_df = pd.read_csv(saadi_file_path)\n"]},{"cell_type":"code","execution_count":2,"id":"40ac5cd2","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:32.49094Z","iopub.status.busy":"2025-11-15T19:57:32.490633Z","iopub.status.idle":"2025-11-15T19:57:32.504553Z","shell.execute_reply":"2025-11-15T19:57:32.503621Z"},"papermill":{"duration":0.018918,"end_time":"2025-11-15T19:57:32.505961","exception":false,"start_time":"2025-11-15T19:57:32.487043","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["âœ… Successfully combined both datasets.\n","Original column order: ['misra1', 'misra2', 'poet']\n"]}],"source":["# add a new column to combine all the poets together\n","\n","molana_df['poet'] = 'Mowlana'\n","saadi_df['poet'] = 'Saadi'\n","\n","all_poems_df = pd.concat([molana_df, saadi_df], ignore_index=True)\n","print(\"âœ… Successfully combined both datasets.\")\n","print(\"Original column order:\", all_poems_df.columns.tolist())"]},{"cell_type":"code","execution_count":3,"id":"3da045ab","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:32.51318Z","iopub.status.busy":"2025-11-15T19:57:32.512901Z","iopub.status.idle":"2025-11-15T19:57:32.532484Z","shell.execute_reply":"2025-11-15T19:57:32.531633Z"},"papermill":{"duration":0.024851,"end_time":"2025-11-15T19:57:32.533845","exception":false,"start_time":"2025-11-15T19:57:32.508994","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>misra1</th>\n","      <th>misra2</th>\n","      <th>poet</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ÛŒÚ©ÛŒ Ú¯Ù†Ø¬ÛŒ Ù¾Ø¯ÛŒØ¯ Ø¢Ù…Ø¯ Ø¯Ø± Ø¢Ù† Ø¯Ú©Ø§Ù† Ø²Ø±Ú©ÙˆØ¨ÛŒ</td>\n","      <td>Ø²Ù‡ÛŒ ØµÙˆØ±Øª Ø²Ù‡ÛŒ Ù…Ø¹Ù†ÛŒ Ø²Ù‡ÛŒ Ø®ÙˆØ¨ÛŒ Ø²Ù‡ÛŒ Ø®ÙˆØ¨ÛŒ</td>\n","      <td>Mowlana</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Ø²Ù‡ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø²Ø±Ú©ÙˆØ¨Ø§Ù† Ø²Ù‡ÛŒ Ø§Ø³Ø±Ø§Ø± ÛŒØ¹Ù‚ÙˆØ¨Ø§Ù†</td>\n","      <td>Ú©Ù‡ Ø¬Ø§Ù† ÛŒÙˆØ³Ù Ø§Ø² Ø¹Ø´Ù‚Ø´ Ø¨Ø±Ø¢Ø±Ø¯ Ø´ÙˆØ± ÛŒØ¹Ù‚ÙˆØ¨ÛŒ</td>\n","      <td>Mowlana</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Ø² Ø¹Ø´Ù‚ Ø§Ùˆ Ø¯Ùˆ ØµØ¯ Ù„ÛŒÙ„ÛŒ Ú†Ùˆ Ù…Ø¬Ù†ÙˆÙ† Ø¨Ù†Ø¯ Ù…ÛŒâ€ŒØ¯Ø±Ø¯</td>\n","      <td>Ú©Ø² Ø§ÛŒÙ† Ø¢ØªØ´ Ø²Ø¨ÙˆÙ† Ø¢ÛŒØ¯ ØµØ¨ÙˆØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙˆØ¨ÛŒ</td>\n","      <td>Mowlana</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Ø´Ø¯Ù‡ Ø²Ø±Ú©ÙˆØ¨ Ùˆ Ø­Ù‚ Ù…Ø§Ù†Ø¯Ù‡ ØªÙ†Ø´ Ú†ÙˆÙ† Ø²Ø±ÙˆØ±Ù‚ Ù…Ø§Ù†Ø¯Ù‡</td>\n","      <td>Ø¬ÙˆØ§Ù‡Ø± Ø¨Ø± Ø·Ø¨Ù‚ Ù…Ø§Ù†Ø¯Ù‡ Ú†Ùˆ Ø²Ø±Ú©ÙˆØ¨ÛŒ Ú©Ø±ÙˆØ¨ÛŒ</td>\n","      <td>Mowlana</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Ø¨ÛŒØ§ Ø¨Ù†ÙˆØ§Ø² Ø¹Ø§Ø´Ù‚ Ø±Ø§ Ú©Ù‡ ØªÙˆ Ø¬Ø§Ù†ÛŒ Ø­Ù‚Ø§ÛŒÙ‚ Ø±Ø§</td>\n","      <td>Ø¨Ø²Ù† Ú¯Ø±Ø¯Ù† Ù…Ù†Ø§ÙÙ‚ Ø±Ø§ Ø§Ú¯Ø± Ø§Ø² ÙˆÛŒ Ø¨ÛŒØ§Ø´ÙˆØ¨ÛŒ</td>\n","      <td>Mowlana</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                     misra1  \\\n","0       ÛŒÚ©ÛŒ Ú¯Ù†Ø¬ÛŒ Ù¾Ø¯ÛŒØ¯ Ø¢Ù…Ø¯ Ø¯Ø± Ø¢Ù† Ø¯Ú©Ø§Ù† Ø²Ø±Ú©ÙˆØ¨ÛŒ   \n","1       Ø²Ù‡ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø²Ø±Ú©ÙˆØ¨Ø§Ù† Ø²Ù‡ÛŒ Ø§Ø³Ø±Ø§Ø± ÛŒØ¹Ù‚ÙˆØ¨Ø§Ù†   \n","2   Ø² Ø¹Ø´Ù‚ Ø§Ùˆ Ø¯Ùˆ ØµØ¯ Ù„ÛŒÙ„ÛŒ Ú†Ùˆ Ù…Ø¬Ù†ÙˆÙ† Ø¨Ù†Ø¯ Ù…ÛŒâ€ŒØ¯Ø±Ø¯   \n","3  Ø´Ø¯Ù‡ Ø²Ø±Ú©ÙˆØ¨ Ùˆ Ø­Ù‚ Ù…Ø§Ù†Ø¯Ù‡ ØªÙ†Ø´ Ú†ÙˆÙ† Ø²Ø±ÙˆØ±Ù‚ Ù…Ø§Ù†Ø¯Ù‡   \n","4     Ø¨ÛŒØ§ Ø¨Ù†ÙˆØ§Ø² Ø¹Ø§Ø´Ù‚ Ø±Ø§ Ú©Ù‡ ØªÙˆ Ø¬Ø§Ù†ÛŒ Ø­Ù‚Ø§ÛŒÙ‚ Ø±Ø§   \n","\n","                                 misra2     poet  \n","0   Ø²Ù‡ÛŒ ØµÙˆØ±Øª Ø²Ù‡ÛŒ Ù…Ø¹Ù†ÛŒ Ø²Ù‡ÛŒ Ø®ÙˆØ¨ÛŒ Ø²Ù‡ÛŒ Ø®ÙˆØ¨ÛŒ  Mowlana  \n","1  Ú©Ù‡ Ø¬Ø§Ù† ÛŒÙˆØ³Ù Ø§Ø² Ø¹Ø´Ù‚Ø´ Ø¨Ø±Ø¢Ø±Ø¯ Ø´ÙˆØ± ÛŒØ¹Ù‚ÙˆØ¨ÛŒ  Mowlana  \n","2   Ú©Ø² Ø§ÛŒÙ† Ø¢ØªØ´ Ø²Ø¨ÙˆÙ† Ø¢ÛŒØ¯ ØµØ¨ÙˆØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙˆØ¨ÛŒ  Mowlana  \n","3    Ø¬ÙˆØ§Ù‡Ø± Ø¨Ø± Ø·Ø¨Ù‚ Ù…Ø§Ù†Ø¯Ù‡ Ú†Ùˆ Ø²Ø±Ú©ÙˆØ¨ÛŒ Ú©Ø±ÙˆØ¨ÛŒ  Mowlana  \n","4   Ø¨Ø²Ù† Ú¯Ø±Ø¯Ù† Ù…Ù†Ø§ÙÙ‚ Ø±Ø§ Ø§Ú¯Ø± Ø§Ø² ÙˆÛŒ Ø¨ÛŒØ§Ø´ÙˆØ¨ÛŒ  Mowlana  "]},"execution_count":3,"metadata":{},"output_type":"execute_result"}],"source":["all_poems_df.head()"]},{"cell_type":"code","execution_count":4,"id":"bbd65c5e","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:32.54145Z","iopub.status.busy":"2025-11-15T19:57:32.541199Z","iopub.status.idle":"2025-11-15T19:57:32.578216Z","shell.execute_reply":"2025-11-15T19:57:32.577211Z"},"papermill":{"duration":0.042579,"end_time":"2025-11-15T19:57:32.579678","exception":false,"start_time":"2025-11-15T19:57:32.537099","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 82194 entries, 0 to 82193\n","Data columns (total 3 columns):\n"," #   Column  Non-Null Count  Dtype \n","---  ------  --------------  ----- \n"," 0   misra1  82194 non-null  object\n"," 1   misra2  82194 non-null  object\n"," 2   poet    82194 non-null  object\n","dtypes: object(3)\n","memory usage: 1.9+ MB\n"]}],"source":["all_poems_df.info()"]},{"cell_type":"code","execution_count":5,"id":"78b5f411","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:32.587216Z","iopub.status.busy":"2025-11-15T19:57:32.586937Z","iopub.status.idle":"2025-11-15T19:57:32.593785Z","shell.execute_reply":"2025-11-15T19:57:32.592978Z"},"papermill":{"duration":0.012228,"end_time":"2025-11-15T19:57:32.595143","exception":false,"start_time":"2025-11-15T19:57:32.582915","status":"completed"},"tags":[]},"outputs":[],"source":["import re\n","import random\n","\n","# this function is used for a program which is related to the Moshaere system (which has regex systems inside of it. There is another function for talking to user )\n","\n","\n","# words are already normalized \n","def find_reply_poem(user_input: str, poems_df: pd.DataFrame, text_column: str) -> str:\n","    \n","    \n","\n","    # Find the last valid Persian letter of the user's input\n","    last_letter = None\n","    for char in reversed(user_input):\n","        if re.match('[Ø¢-ÛŒ]', char):\n","            last_letter = char\n","            break # Stop as soon as we find the first valid letter from the end\n","\n","    if last_letter is None:\n","        return \"Ù…ØªØ§Ø³ÙØ§Ù†Ù‡ Ø­Ø±Ù Ù…Ù†Ø§Ø³Ø¨ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø´Ø¹Ø± Ø¨Ø¹Ø¯ÛŒ Ø¯Ø± Ù¾ÛŒØ§Ù… Ø´Ù…Ø§ Ù¾ÛŒØ¯Ø§ Ù†Ú©Ø±Ø¯Ù…. Ù„Ø·ÙØ§ ÛŒÚ© Ø¨ÛŒØª Ø´Ø¹Ø± Ø¨ÙØ±Ø³ØªÛŒØ¯.\"\n","\n","    print(f\"DEBUG: User's last letter is '{last_letter}'. Searching for a reply...\")\n","\n","    # Build the regex pattern to find a poem starting with that letter\n","    #    ^ means \"start of the string\"\n","    regex_pattern = f\"^{last_letter}\"\n","\n","    # .str.contains() with regex=True is a powerful way to apply regex to a pandas column\n","    # na=False handles any potential empty/null rows gracefully\n","    matching_poems = poems_df[poems_df[text_column].str.contains(regex_pattern, regex=True, na=False)]\n","\n","    #Select a response\n","    if not matching_poems.empty:\n","        # we found at least one match. Lets pick one randomly.\n","        random_poem_row = matching_poems.sample(1).iloc[0]\n","        \n","        misra1 = random_poem_row['misra1']\n","        misra2 = random_poem_row['misra2']\n","        poet_name = random_poem_row['poet']\n","        \n","        return f\"{misra1}\\n{misra2}\\n\\n- {poet_name}\"\n","    \n","    else:\n","        # If the DataFrame of matches is empty, we couldn't find a reply.\n","        return f\"Ø´Ø¹Ø±ÛŒ Ú©Ù‡ Ø¨Ø§ Ø§ÛŒÙ† Ø­Ø±Ù Ø´Ø±ÙˆØ¹ Ø´Ù‡ Ù¾ÛŒØ¯Ø§ Ù†Ú©Ø±Ø¯Ù… \"\n"]},{"cell_type":"code","execution_count":6,"id":"eaa1ed27","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:32.602757Z","iopub.status.busy":"2025-11-15T19:57:32.602495Z","iopub.status.idle":"2025-11-15T19:57:32.609014Z","shell.execute_reply":"2025-11-15T19:57:32.608317Z"},"papermill":{"duration":0.012036,"end_time":"2025-11-15T19:57:32.610304","exception":false,"start_time":"2025-11-15T19:57:32.598268","status":"completed"},"tags":[]},"outputs":[],"source":["CONVERSATION_PATTERNS = {\n","    # hello!\n","    r\"\\b(Ø³Ù„Ø§Ù…|Ø¯Ø±ÙˆØ¯)\": [\n","        \"Ø³Ù„Ø§Ù… Ø¨Ø± Ø´Ù…Ø§! Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ø¹Ø±Ù‡ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒØ¯ØŸ\",\n","        \"Ø¯Ø±ÙˆØ¯! Ú†Ù‡ Ø®ÙˆØ¨ Ú©Ù‡ Ø§ÛŒÙ†Ø¬Ø§ÛŒÛŒØ¯. Ø§Ù…Ø±ÛŒ Ø¯Ø§Ø´ØªÛŒØ¯ØŸ\",\n","        \"Ø³Ù„Ø§Ù…! Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\"\n","    ],\n","    r\"\\b(Ú†Ø·ÙˆØ±ÛŒ|Ø®ÙˆØ¨ÛŒ|Ú†Ù‡ Ø®Ø¨Ø±)\": [\n","        \"Ù…Ù…Ù†ÙˆÙ† Ø§Ø² Ø´Ù…Ø§. Ù…Ù† ÛŒÚ© Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù‡Ø³ØªÙ… Ùˆ Ù‡Ù…ÛŒØ´Ù‡ Ø¯Ø± Ø¨Ù‡ØªØ±ÛŒÙ† Ø­Ø§Ù„ Ù…Ù…Ú©Ù†Ù…!\",\n","        \"Ø¹Ø§Ù„ÛŒâ€ŒØ§Ù… Ùˆ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ù…Ø´Ø§Ø¹Ø±Ù‡ Ø¬Ø§Ù†Ø§Ù†Ù‡!\",\n","        \"Ù‡Ù…Ù‡ Ú†ÛŒØ² Ù…Ø±ØªØ¨ Ø§Ø³Øª. Ø´Ù…Ø§ Ú†Ø·ÙˆØ±ÛŒØ¯ØŸ\"\n","    ],\n","    \n","    # abalities \n","    r\"\\b(Ú©ÛŒ Ù‡Ø³ØªÛŒ|Ø§Ø³Ù…Øª Ú†ÛŒÙ‡|Ù…Ø¹Ø±ÙÛŒ Ú©Ù†)\": [\n","        \"Ù…Ù† ÛŒÚ© Ø±Ø¨Ø§Øª Ù…Ø´Ø§Ø¹Ø±Ù‡ Ù‡Ø³ØªÙ… Ú©Ù‡ Ø¨Ø§ Ú¯Ù†Ø¬ÛŒÙ†Ù‡ Ø§Ø´Ø¹Ø§Ø± Ù…ÙˆÙ„Ø§Ù†Ø§ Ùˆ Ø³Ø¹Ø¯ÛŒ Ø¢Ø´Ù†Ø§ÛŒÙ….\",\n","        \"Ù†Ø§Ù… Ù…Ù† Â«Ø³Ø®Ù†â€ŒÛŒØ§Ø±Â» Ø§Ø³Øª. Ø¨Ø±Ø§ÛŒ Ú©Ù…Ú© Ø¨Ù‡ Ø´Ù…Ø§ Ø¯Ø± Ø¯Ù†ÛŒØ§ÛŒ Ø´Ø¹Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù‡Ø³ØªÙ….\",\n","        \"Ù…Ù† ÛŒÚ© Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ Ø¨Ù‡ Ø´Ø¹Ø± ÙØ§Ø±Ø³ÛŒ Ù‡Ø³ØªÙ….\"\n","    ],\n","    r\"\\b(Ú†ÛŒÚ©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†ÛŒ|Ú©Ø§Ø± ØªÙˆ Ú†ÛŒÙ‡|ØªÙˆØ§Ù†Ø§ÛŒÛŒ)\": [\n","        \"Ú©Ø§Ø± Ø§ØµÙ„ÛŒ Ù…Ù† Ù…Ø´Ø§Ø¹Ø±Ù‡ Ø§Ø³Øª. Ø´Ù…Ø§ ÛŒÚ© Ø¨ÛŒØª Ø´Ø¹Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†ÛŒØ¯ Ùˆ Ù…Ù† Ø¯Ø± Ø¬ÙˆØ§Ø¨ØŒ Ø¨ÛŒØªÛŒ Ø¨Ø§ Ø­Ø±Ù Ø¢Ø®Ø± Ø¢Ù† Ø¨Ø±Ø§ÛŒØªØ§Ù† Ù¾ÛŒØ¯Ø§ Ù…ÛŒâ€ŒÚ©Ù†Ù….\",\n","        \"Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ø¨Ø§ Ø´Ù…Ø§ Ù…Ø´Ø§Ø¹Ø±Ù‡ Ú©Ù†Ù…ØŒ Ø´Ø§Ø¹Ø± Ø§Ø­ØªÙ…Ø§Ù„ÛŒ ÛŒÚ© Ø¨ÛŒØª Ø±Ø§ Ø­Ø¯Ø³ Ø¨Ø²Ù†Ù… Ùˆ Ø¨Ù‡ Ø³ÙˆØ§Ù„Ø§Øª Ú©Ù„ÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø´Ø¹Ø± Ù¾Ø§Ø³Ø® Ø¯Ù‡Ù….\",\n","        \"Ù…Ù† Ø¨Ø±Ø§ÛŒ Ø´Ø¹Ø± Ùˆ Ø´Ø§Ø¹Ø±ÛŒ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡â€ŒØ§Ù…! Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… Ù…Ø´Ø§Ø¹Ø±Ù‡ Ú©Ù†ÛŒÙ….\"\n","    ],\n","\n","    # poets information\n","    r\"\\b(Ú©ÛŒØ§ Ù‡Ø³ØªÙ†|Ø´Ø§Ø¹Ø±Ø§ Ú©ÛŒØ§|Ø§Ø² Ú©ÛŒ Ø´Ø¹Ø± Ø¯Ø§Ø±ÛŒ)\": [\n","        \"Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ú¯Ù†Ø¬ÛŒÙ†Ù‡ Ù…Ù† Ø´Ø§Ù…Ù„ Ø§Ø´Ø¹Ø§Ø± Ø¯Ùˆ Ø¨Ø²Ø±Ú¯ÙˆØ§Ø±ØŒ Ù…ÙˆÙ„Ø§Ù†Ø§ Ø¬Ù„Ø§Ù„â€ŒØ§Ù„Ø¯ÛŒÙ† Ø¨Ù„Ø®ÛŒ Ùˆ Ø³Ø¹Ø¯ÛŒ Ø´ÛŒØ±Ø§Ø²ÛŒ Ø§Ø³Øª.\",\n","        \"Ù…Ù† Ø¨Ø§ Ø¯ÛŒÙˆØ§Ù† Ø´Ù…Ø³ Ù…ÙˆÙ„Ø§Ù†Ø§ Ùˆ ØºØ²Ù„ÛŒØ§Øª Ø³Ø¹Ø¯ÛŒ Ø¢Ø´Ù†Ø§ Ù‡Ø³ØªÙ….\",\n","    ],\n","    \n","    # thanks!\n","    r\"\\b(Ù…Ù…Ù†ÙˆÙ†|Ù…Ø±Ø³ÛŒ|Ø³Ù¾Ø§Ø³)\": [\n","        \"Ø®ÙˆØ§Ù‡Ø´ Ù…ÛŒâ€ŒÚ©Ù†Ù…. Ø¨Ø§Ø¹Ø« Ø®ÙˆØ´Ø­Ø§Ù„ÛŒ Ù…Ù† Ø§Ø³Øª.\",\n","        \"ÙˆØ¸ÛŒÙÙ‡ Ø¨ÙˆØ¯. Ø¨Ø§Ø² Ù‡Ù… Ø¯Ø± Ø®Ø¯Ù…ØªÙ….\",\n","        \"Ø®ÙˆØ´Ø­Ø§Ù„Ù… Ú©Ù‡ ØªÙˆØ§Ù†Ø³ØªÙ… Ú©Ù…Ú©ÛŒ Ú©Ù†Ù….\"\n","    ],\n","    r\"\\b(Ø®Ø¯Ø§Ø­Ø§ÙØ¸|Ø¨Ø¯Ø±ÙˆØ¯|ÙØ¹Ù„Ø§)\": [\n","        \"Ø±ÙˆØ² Ø®ÙˆØ´. Ø¨Ù‡ Ø§Ù…ÛŒØ¯ Ø¯ÛŒØ¯Ø§Ø± Ø¯ÙˆØ¨Ø§Ø±Ù‡!\",\n","        \"Ø®Ø¯Ø§Ù†Ú¯Ù‡Ø¯Ø§Ø± Ø´Ù…Ø§.\",\n","        \"Ù…Ø±Ø§Ù‚Ø¨ Ø®ÙˆØ¯ØªØ§Ù† Ø¨Ø§Ø´ÛŒØ¯.\"\n","    ],\n","    \n","    # help\n","    r\"\\b(Ú©Ù…Ú©|Ø±Ø§Ù‡Ù†Ù…Ø§|Ú†Ø·ÙˆØ± Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†ÛŒ)\": [\n","        \"Ø®ÛŒÙ„ÛŒ Ø³Ø§Ø¯Ù‡! ÛŒØ§ ÛŒÚ© Ø¨ÛŒØª Ø´Ø¹Ø± Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ù…Ø´Ø§Ø¹Ø±Ù‡ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ØŒ ÛŒØ§ Ø³ÙˆØ§Ù„ÛŒ Ø§Ø² Ù…Ù† Ø¨Ù¾Ø±Ø³ÛŒØ¯.\",\n","        \"Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù…Ø´Ø§Ø¹Ø±Ù‡ Ú©Ù†ÛŒÙ…ØŒ ÛŒÚ© Ø¨ÛŒØª Ø´Ø¹Ø± Ø¨ÙØ±Ø³ØªÛŒØ¯. Ø¯Ø± ØºÛŒØ± Ø§ÛŒÙ† ØµÙˆØ±ØªØŒ Ù‡Ø± Ø³ÙˆØ§Ù„ÛŒ Ø¯Ø§Ø±ÛŒØ¯ Ø¨Ù¾Ø±Ø³ÛŒØ¯. Ù…Ø«Ù„Ø§: Â«Ø§Ø² Ø³Ø¹Ø¯ÛŒ Ú†Ù‡ Ø´Ø¹Ø±Ù‡Ø§ÛŒÛŒ Ø¯Ø§Ø±ÛŒØŸÂ»\"\n","    ]\n","}\n","\n","def handle_conversation(user_input: str) -> str | None:\n","    \n","    for pattern, responses in CONVERSATION_PATTERNS.items():\n","        if re.search(pattern, user_input, re.IGNORECASE):\n","            return random.choice(responses)\n","    \n","    return None"]},{"cell_type":"markdown","id":"c8149965","metadata":{"papermill":{"duration":0.00279,"end_time":"2025-11-15T19:57:32.616108","exception":false,"start_time":"2025-11-15T19:57:32.613318","status":"completed"},"tags":[]},"source":["- I used the code below for detecting the user's preferred poet"]},{"cell_type":"code","execution_count":7,"id":"5960cf4b","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:32.623254Z","iopub.status.busy":"2025-11-15T19:57:32.622991Z","iopub.status.idle":"2025-11-15T19:57:32.63357Z","shell.execute_reply":"2025-11-15T19:57:32.632818Z"},"papermill":{"duration":0.016112,"end_time":"2025-11-15T19:57:32.635066","exception":false,"start_time":"2025-11-15T19:57:32.618954","status":"completed"},"tags":[]},"outputs":[],"source":["# list of words \n","MOWLANA_KEYWORDS = [\n","    \"Ø´Ù…Ø³\", \"ØªØ¨Ø±ÛŒØ²\", \"ØªØ¨Ø±ÛŒØ²ÛŒ\", \"Ø®Ø§Ù…ÙˆØ´\", \"Ù…ÙˆÙ„Ø§Ù†Ø§\", \"Ù…ÙˆÙ„ÙˆÛŒ\", \"Ø±ÙˆÙ…ÛŒ\",\n","    \"ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÛŒÙ†\", \"Ø­Ø³Ø§Ù… Ø§Ù„Ø¯ÛŒÙ†\", \"Ø°ÙˆØ§Ù„Ø¬Ù„Ø§Ù„\", \"Ø°ÙˆØ§Ù„ÙÙ‚Ø§Ø±\",\n","    \"Ø³Ù…Ø§Ø¹\", \"Ø³Ù„Ø·Ø§Ù†\", \"Ø¢ÙØªØ§Ø¨\", \"Ø®ÙˆØ±Ø´ÛŒØ¯\", \"Ù‚Ù…Ø±\", \"Ù…Ø§Ù‡\", \"Ù…Ø³Øª\", \"Ù…Ø³ØªØ§Ù†\", \"Ù…Ø³ØªÛŒ\", \"Ø¯ÛŒÙˆØ§Ù†Ù‡\", \n","    \"Ø³Ø§Ù‚ÛŒ\", \"Ø¨Ø§Ø¯Ù‡\", \"Ø´Ø±Ø§Ø¨\", \"Ø§Ø³Ø±Ø§Ø±\", \"Ø®Ø±Ø§Ø¨Ø§Øª\", \"Ù…Ø¹Ø´ÙˆÙ‚\", \"Ø¹Ø§Ø´Ù‚Ø§Ù†\", \"Ø¹Ø§Ø´Ù‚ÛŒ\",\n","    \"Ø¢Ø³Ù…Ø§Ù†\", \"Ø§ÙÙ„Ø§Ú©\", \"Ú¯Ø±Ø¯ÙˆÙ†\", \"Ù¾Ù†Ù‡Ø§Ù†\", \"Ø®ÙˆØ§Ø¬Ù‡\", \"Ø§ÛŒØ´Ø§Ù†\", \"Ø§ÛŒÙ…Ø§Ù†\",\n","    \"Ø®Ù†Ø¯Ø§Ù†\", \"Ø±Ù‚Øµ\", \"Ø¯ÛŒÙˆØ§Ù†Ú¯ÛŒ\", \"Ø³Ù„ÛŒÙ…Ø§Ù†\", \"Ø³Ù„ÛŒÙ…Ø§Ù†ÛŒ\", \"Ù¾ÛŒØºØ§Ù…Ø¨Ø±\", \"Ø´Ú©Ø±Ø³ØªØ§Ù†\", \"Ù‡Ù†Ø¯Ø³ØªØ§Ù†\",\n","    \"Ø¨Ø§Øº\", \"Ø¨Ø³ØªØ§Ù†\", \"Ú¯Ù„Ø³ØªØ§Ù†\", \n","    \"Ø¬Ù…Ù„Ù‡\", \"Ù‡Ù…Ú†Ùˆ\", \"Ø®Ø§Ù†Ù‡\", \"Ú¯Ø±Ø¯Ø¯\", \"Ú¯ÙˆÛŒØ¯\", \"Ø²Ù…ÛŒÙ†\", \"Ù¾Ø±ÙˆØ§Ù†Ù‡\", \"Ù†Ø§Ú¯Ù‡Ø§Ù†\",\n","    \"Ø³Ø±Ú¯Ø±Ø¯Ø§Ù†\", \"Ø§Ø¨Ø±Ø§Ù‡ÛŒÙ…\", \"Ù¾Ø´ÛŒÙ…Ø§Ù†ÛŒ\", \"Ú¯ÙˆØ±Ø³ØªØ§Ù†\", \"Ø¨ÙˆØ§Ù„Ø¹Ø¬Ø¨\", \"Ù…Ø³Ù„Ù…Ø§Ù†Ø§Ù†\", \"Ø±ÙˆØ­Ø§Ù†ÛŒØ§Ù†\",\n","    \"ØµÙˆØ±Øª\", \"Ù…Ø¹Ù†ÛŒ\", \" Ø¹Ø¯Ù…\", \"ÙˆØ¬ÙˆØ¯\", \"Ø°Ø±Ù‡\", \"Ø¯Ø±ÛŒØ§\", \"Ù…ÙˆØ¬\", \"Ú¯ÙˆÙ‡Ø±\", \"ØµØ¯Ù\",\n","    \"Ø¬Ø§Ù†Ø§Ù†\", \"Ø´ÛŒØ±ÛŒÙ†\", \"Ø®Ø³Ø±Ùˆ\", \"ÙØ±Ù‡Ø§Ø¯\", \"ÛŒÙˆØ³Ù\", \"ÛŒØ¹Ù‚ÙˆØ¨\", \"Ù…ÙˆØ³ÛŒ\", \"Ø¹ÛŒØ³ÛŒ\",\n","    \"Ø¢ØªØ´\", \"Ù†ÙˆØ±\", \"Ú†Ø±Ø§Øº\", \"Ø´Ù…Ø¹\",\"Ø¹Ø´Ù‚\"\n","]\n","SAADI_KEYWORDS = [\n","    \"Ø³Ø¹Ø¯ÛŒ\", \"Ø³Ø¹Ø¯ÛŒØ§\", \"Ú¯Ù„Ø³ØªØ§Ù†\", \"Ø¨ÙˆØ³ØªØ§Ù†\", \"Ø´ÛŒØ±Ø§Ø²\",\n","    \"Ø¯ÙˆØ³ØªØ§Ù†\", \"Ø¯ÙˆØ³ØªÛŒ\", \"Ø¯Ø´Ù…Ù†\", \"Ø¯Ø´Ù…Ù†Ø§Ù†\", \"Ø¹Ù‡Ø¯\", \"Ù¾ÛŒÙ…Ø§Ù†\", \"ÙˆÙØ§\", \"Ø¬ÙØ§\",\n","    \"Ù¾Ø§Ø¯Ø´Ø§Ù‡\", \"Ù¾Ø§Ø¯Ø´Ù‡\", \"Ù¾Ø§Ø¯Ø´Ø§Ù‡Ø§Ù†\", \"Ù…Ù„Ú©\", \"Ø¯Ø±ÙˆÛŒØ´\", \"Ø¯Ø±ÙˆÛŒØ´Ø§Ù†\", \"ØªÙˆØ§Ù†Ú¯Ø±\",\n","    \"Ø®Ø±Ø¯Ù…Ù†Ø¯\", \"Ø®Ø±Ø¯Ù…Ù†Ø¯Ø§Ù†\", \"Ø±ÙˆØ²Ú¯Ø§Ø±\", \"Ø¢Ø¯Ù…ÛŒ\", \"Ø¢Ø¯Ù…ÛŒØª\", \"Ø¨Ù†ÛŒ Ø¢Ø¯Ù…\", \"ØµØ§Ø­Ø¨Ø¯Ù„Ø§Ù†\", \"ØµØ§Ø­Ø¨Ø¯Ù„\",\n","    \"Ø¯ÙˆÙ„Øª\", \"Ø¹Ø§Ù„Ù…\", \"Ù…Ø±Ø¯Ù…\", \"Ù…Ø³Ú©ÛŒÙ†\", \"ØºØ±ÛŒØ¨\", \"ÛŒØªÛŒÙ…\", \"Ø§Ø³ÛŒØ±\", \"Ø²Ù†Ø¯Ø§Ù†\",\n","    \"Ø­Ú©Ø§ÛŒØª\", \"Ù†ØµÛŒØ­Øª\", \"Ù¾Ù†Ø¯\", \"Ø§Ø¯Ø¨\", \"ØªØ±Ø¨ÛŒØª\",\n","    \"Ø²Ù†Ø¯Ú¯Ø§Ù†ÛŒ\", \"Ù…Ù‡Ø±Ø¨Ø§Ù†ÛŒ\", \"Ø§Ù…ÛŒØ¯ÙˆØ§Ø±\", \"Ù¾Ø§Ø±Ø³Ø§ÛŒÛŒ\", \"Ù¾Ø³Ù†Ø¯ÛŒØ¯Ù‡\", \"Ø´Ú©ÛŒØ¨Ø§ÛŒÛŒ\", \"Ø¬ÙˆØ§Ù†Ù…Ø±Ø¯\", \"Ø¬ÙˆØ§Ù†Ù…Ø±Ø¯ÛŒ\",\n","    \"Ù¾Ø±ÙˆØ±Ø¯Ú¯Ø§Ø±\", \"Ø®Ø¯Ø§ÙˆÙ†Ø¯\", \"Ø²ÛŒØ±Ø¯Ø³ØªØ§Ù†\", \"Ø¯Ø±Ø¯Ù…Ù†Ø¯Ø§Ù†\", \"Ù¾Ø±Ù‡ÛŒØ²Ú¯Ø§Ø±\", \"ÙØ±Ù…Ø§Ù†Ø¯Ù‡ÛŒ\",\n","    \"Ù‡Ø²Ø§Ø±\", \"Ø¯ÛŒÚ¯Ø±\", \"Ø´ÛŒØ±ÛŒÙ†\", \"Ù‚ÛŒØ§Ù…Øª\", \"Ø´Ù…Ø´ÛŒØ±\", \"ØªÛŒØ±\", \"Ú©Ù…Ø§Ù†\", \"Ø³Ù¾Ø±\",\n","    \"ÙˆÙ„ÛŒÚ©Ù†\", \"Ú¯ÙˆÛŒÙ†Ø¯\", \"Ø´Ù†ÛŒØ¯Ù…\", \"Ø®ÙˆÛŒØ´\", \"Ø®ÙˆÛŒØ´ØªÙ†\", \"Ø§Ù†Ø¯ÛŒØ´Ù‡\", \"Ø¨ÛŒÚ†Ø§Ø±Ù‡\", \"Ø§Ø®ØªÛŒØ§Ø±\", \"Ú¯Ø±ÙØªØ§Ø±\",\n","    \"Ø³ÙØ±\", \"Ù†Ø¸Ø±\", \"Ø®Ø¨Ø±\", \"Ù‡Ù†Ø±\", \"Ú¯Ø°Ø±\", \"Ù¾Ø³Ø±\", \"Ù¾Ø¯Ø±\",\n","    \"ØµÙˆØ±Øª\", \"Ù…Ù„Ø§Ù…Øª\", \"Ø³Ù„Ø§Ù…Øª\", \"Ù‚Ø¶Ø§\", \"Ù‚Ø¶Ø§ÙˆØª\"\n","]\n","\n","\n","def guess_the_poet(user_input: str) -> str:\n","    \"\"\"\n","    Ø¨Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ø¯Ø± Ø´Ø¹Ø± Ú©Ø§Ø±Ø¨Ø±ØŒ Ø´Ø§Ø¹Ø± Ø¢Ù† Ø±Ø§ Ø­Ø¯Ø³ Ù…ÛŒâ€ŒØ²Ù†Ø¯.\n","    \"\"\"\n","    mowlana_score = 0\n","    saadi_score = 0\n","    \n","    \n","    # pattern for finding words\n","    mowlana_pattern = r\"\\b(\" + \"|\".join(MOWLANA_KEYWORDS) + r\")\\b\"\n","    saadi_pattern = r\"\\b(\" + \"|\".join(SAADI_KEYWORDS) + r\")\\b\"\n","    \n","    # lenght of this is our score\n","    mowlana_matches = re.findall(mowlana_pattern, user_input)\n","    saadi_matches = re.findall(saadi_pattern, user_input)\n","    \n","    mowlana_score = len(mowlana_matches)\n","    saadi_score = len(saadi_matches)\n","    \n","    # Ù†Ù…Ø§ÛŒØ´ Ø§Ù…ØªÛŒØ§Ø²Ø§Øª Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¨Ø§Ú¯ Ú©Ø±Ø¯Ù† (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø¹Ø¯Ø§Ù‹ Ø§ÛŒÙ† Ø®Ø· Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯)\n","    print(f\"DEBUG: Mowlana Score: {mowlana_score} (Matches: {mowlana_matches}) | Saadi Score: {saadi_score} (Matches: {saadi_matches})\")\n","    \n","    # Ù‚Ø¯Ù… Ú†Ù‡Ø§Ø±Ù…: Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø§Ù…ØªÛŒØ§Ø²Ø§Øª Ùˆ Ø§Ø¹Ù„Ø§Ù… Ù†ØªÛŒØ¬Ù‡\n","    if mowlana_score > saadi_score:\n","        return \"Ø¨Ù‡ Ù†Ø¸Ø±Ù… Ø§ÛŒÙ† Ø´Ø¹Ø± Ø§Ø² Ù…ÙˆÙ„Ø§Ù†Ø§Ø³Øª. Ø§Ù†ØªØ®Ø§Ø¨ Ø²ÛŒØ¨Ø§ÛŒÛŒ Ø¨ÙˆØ¯!\"\n","    elif saadi_score > mowlana_score:\n","        return \"ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù… Ø§ÛŒÙ† Ø¨ÛŒØª Ø§Ø² Ø³Ø¹Ø¯ÛŒ Ø¨Ø§Ø´Ø¯. Ø¨Ø³ÛŒØ§Ø± Ø¯Ù„Ù†Ø´ÛŒÙ†!\"\n","    elif mowlana_score > 0 and mowlana_score == saadi_score:\n","        return \"Ú†Ù‡ Ø¬Ø§Ù„Ø¨! Ø§ÛŒÙ† Ø´Ø¹Ø± Ù‡Ù… Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ù…ÙˆÙ„Ø§Ù†Ø§ Ùˆ Ù‡Ù… Ø³Ø¹Ø¯ÛŒ Ø±Ø§ Ø¯Ø§Ø±Ø¯. ØªØ´Ø®ÛŒØµØ´ Ø¨Ø±Ø§ÛŒÙ… Ø³Ø®Øª Ø§Ø³Øª.\"\n","    else:\n","        # Ø§Ú¯Ø± Ù‡ÛŒÚ† Ú©Ù„Ù…Ù‡ Ú©Ù„ÛŒØ¯ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯ØŒ Ù‡ÛŒÚ† Ù¾ÛŒØ§Ù…ÛŒ Ø¨Ø±Ù†Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†ÛŒÙ…\n","        return \"ÙØ¹Ù„Ø§ Ù…Ù† Ù…Ø¯Ù„ Ø³Ø§Ø¯Ù‡ Ø§ÛŒ Ù‡Ø³ØªÙ… Ù†Ù…ÛŒ ØªÙˆØ§Ù†Ù… Ø®ÙˆØ¨ Ø¨ÙÙ‡Ù…Ù… Ú©Ø¯Ø§Ù… Ø´Ø§Ø¹Ø± Ø§Ø³Øª\"\n"]},{"cell_type":"markdown","id":"aa5d20c3","metadata":{"papermill":{"duration":0.00295,"end_time":"2025-11-15T19:57:32.640998","exception":false,"start_time":"2025-11-15T19:57:32.638048","status":"completed"},"tags":[]},"source":["- This function handles Eliza-style talking for the user. "]},{"cell_type":"code","execution_count":8,"id":"0515bef1","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:32.648417Z","iopub.status.busy":"2025-11-15T19:57:32.648119Z","iopub.status.idle":"2025-11-15T19:57:32.657421Z","shell.execute_reply":"2025-11-15T19:57:32.656577Z"},"papermill":{"duration":0.015131,"end_time":"2025-11-15T19:57:32.658907","exception":false,"start_time":"2025-11-15T19:57:32.643776","status":"completed"},"tags":[]},"outputs":[],"source":["import re\n","import random\n","\n","PRONOUN_SWAP = {\n","    \"Ù…Ù†\": \"Ø´Ù…Ø§\",\n","    \"Ù…\": \"Øª\",      \n","    \"Ø§Ù…\": \"Ù‡Ø³ØªÛŒØ¯\",   \n","    \"Ø¯Ø§Ø±Ù…\": \"Ø¯Ø§Ø±ÛŒØ¯\",\n","    \"Ø´Ù…Ø§\": \"Ù…Ù†\",\n","    \"Øª\": \"Ù…\",\n","    \"Ù‡Ø³ØªÛŒØ¯\": \"Ù‡Ø³ØªÙ…\",\n","    \"Ø¯Ø§Ø±ÛŒØ¯\": \"Ø¯Ø§Ø±Ù…\"\n","}\n","\n","POETIC_ELIZA_RULES = {\n"," \n","    \"#FAMILY_RULE#.*\\\\b(Ø¹Ø²ÛŒØ²Ù…|Ø¯Ø®ØªØ±Ù…|Ù¾Ø³Ø±Ù…|Ù…Ø§Ø¯Ø±Ù…|Ù¾Ø¯Ø±Ù…|Ø®ÙˆØ§Ù‡Ø±Ù…|Ø¨Ø±Ø§Ø¯Ø±Ù…|Ø¹Ø´Ù‚Ù…|ÛŒØ§Ø±Ù…|Ø¯ÙˆØ³ØªÙ…)\\\\b(.*)\": [\n","        \"Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¨Ø±Ø§ÛŒØªØ§Ù† Ø´Ø¹Ø±ÛŒ Ø¯Ø± ÙˆØµÙ {0} Ø¨Ø®ÙˆØ§Ù†Ù…ØŸ\",\n","        \"Ø´Ø§Ø¹Ø±Ø§Ù† Ø¨Ø³ÛŒØ§Ø±ÛŒ Ø¯Ø± Ù…ÙˆØ±Ø¯ {0} Ø³Ø±ÙˆØ¯Ù‡â€ŒØ§Ù†Ø¯. Ø­Ø³ Ø´Ù…Ø§ Ú†ÛŒØ³ØªØŸ\",\n","        \"Ú†Ù‡ Ø²ÛŒØ¨Ø§ Ø§Ø² {0} ÛŒØ§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯. Ø±Ø§Ø¨Ø·Ù‡â€ŒØªØ§Ù† Ú†Ú¯ÙˆÙ†Ù‡ Ø§Ø³ØªØŸ\"\n","    ],\n","    r\".* Ù…Ù† (.*)\": [\n","        \"Ø§ÛŒÙ†Ú©Ù‡ Ù…ÛŒâ€ŒÚ¯ÙˆÛŒÛŒØ¯ Â«Ù…Ù† {0}Â»ØŒ Ø´Ù…Ø§ Ø±Ø§ Ø¨Ù‡ ÛŒØ§Ø¯ Ú©Ø¯Ø§Ù… Ø´Ø¹Ø± Ù…ÛŒâ€ŒØ§Ù†Ø¯Ø§Ø²Ø¯ØŸ\",\n","        \"Ø´Ø§Ø¹Ø±Ø§Ù† Ø§ÛŒÙ† Ø­Ø§Ù„ Ø´Ù…Ø§ Ø±Ø§ Ú†Ú¯ÙˆÙ†Ù‡ ÙˆØµÙ Ú©Ø±Ø¯Ù‡â€ŒØ§Ù†Ø¯ØŸ Â«{0}Â»...\",\n","        \"Ø¢ÛŒØ§ Ø§ÛŒÙ† Ø§Ø­Ø³Ø§Ø³ØŒ Ø³Ø±Ú†Ø´Ù…Ù‡â€ŒÛŒ Ø´Ø¹Ø±ÛŒ Ø¯Ø± Ø¯Ø±ÙˆÙ† Ø´Ù…Ø§ Ù†ÛŒØ³ØªØŸ\"\n","    ],\n","    r\".* Ú†ÙˆÙ† (.*)\": [\n","        \"Ø¯Ø± Ø¯Ø§Ø³ØªØ§Ù† Ø´Ù…Ø§ØŒ Â«{0}Â» Ù†Ù‚Ø´ Ø§ØµÙ„ÛŒ Ø±Ø§ Ø¯Ø§Ø±Ø¯ØŸ\",\n","        \"Ø¨Ø³ÛŒØ§Ø± Ø®Ø¨... Ù¾Ø³ Ø±ÛŒØ´Ù‡â€ŒÛŒ Ø§ÛŒÙ† Ø§Ø­Ø³Ø§Ø³ Â«{0}Â» Ø§Ø³Øª. Ø¨ÛŒØ´ØªØ± Ø¨Ú¯ÙˆÛŒÛŒØ¯.\",\n","        \"Ø¢ÛŒØ§ Ø§ÛŒÙ† Ø¯Ù„ÛŒÙ„ÛŒ Ø§Ø³Øª Ú©Ù‡ ÛŒÚ© Ø´Ø§Ø¹Ø± Ø¨Ø±Ø§ÛŒ Ø³Ø±ÙˆØ¯Ù† Ø´Ø¹Ø±Ø´ Ù…ÛŒâ€ŒØ¢ÙˆØ±Ø¯ØŸ Â«{0}Â»...\"\n","    ],\n","    r\".*\\b(Ù…ÛŒØ®ÙˆØ§Ù‡Ù…|Ø®ÙˆØ§Ù‡Ù…|Ù†Ø¸Ø±|Ø¹Ù„Øª|Ú†Ø±Ø§|Ú†Ø±Ø§ÛŒÛŒ|Ø¨Ø±Ø§ÛŒ|Ú†Ù‡ Ú©Ø³ÛŒ|Ú†Ú¯ÙˆÙ†Ù‡|Ù‚ØµØ¯)\\b(.*)\": [\n","        \"Ø§ÛŒÙ† Ø®ÙˆØ§Ø³ØªÙ‡â€ŒÛŒ Ø´Ù…Ø§ØŒ Â«{0}Â»ØŒ Ø¢ØºØ§Ø² Ú©Ø¯Ø§Ù… Ù‚ØµÛŒØ¯Ù‡ Ø§Ø³ØªØŸ\",\n","        \"Ø´ÙˆÙ‚Ù Â«{0}Â»... Ø´Ø§Ø¹Ø±Ø§Ù† Ø¨Ø³ÛŒØ§Ø±ÛŒ Ø§Ø² Ú†Ù†ÛŒÙ† Ø´ÙˆÙ‚ÛŒ Ø³Ø±ÙˆØ¯Ù‡â€ŒØ§Ù†Ø¯. Ø´ÙˆÙ‚ Ø´Ù…Ø§ Ø§Ø² Ú©Ø¬Ø§ Ù…ÛŒâ€ŒØ¢ÛŒØ¯ØŸ\",\n","        \"Ø§Ú¯Ø± Ø¨Ù‡ Ø§ÛŒÙ† Ø®ÙˆØ§Ø³ØªÙ‡ Ø®ÙˆØ¯ ÛŒØ¹Ù†ÛŒ Â«{0}Â» Ø¨Ø±Ø³ÛŒØ¯ØŒ Ø¨ÛŒØª Ù¾Ø§ÛŒØ§Ù†ÛŒ ØºØ²Ù„ Ø²Ù†Ø¯Ú¯ÛŒâ€ŒØªØ§Ù† Ú†Ù‡ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯ØŸ\"\n","    ],\n","}\n","\n","FALLBACK_RESPONSES = [\n","    \"Ø¬Ø§Ù„Ø¨ Ø§Ø³Øª... Ø§ÛŒÙ† Ø³Ø®Ù† Ø´Ù…Ø§ Ø¬Ø§ÛŒ ØªØ§Ù…Ù„ Ø¯Ø§Ø±Ø¯. Ø¨ÛŒØ´ØªØ± Ø¨Ú¯ÙˆÛŒÛŒØ¯.\",\n","    \"Ù„Ø·ÙØ§Ù‹ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ù‡ÛŒØ¯ØŒ Ù…Ø´ØªØ§Ù‚ Ø´Ù†ÛŒØ¯Ù†Ù….\",\n","    \"Ø§ÛŒÙ† Ø±Ø§ Ú©Ù‡ Ú¯ÙØªÛŒØ¯ØŒ Ú†Ù‡ Ø§Ø­Ø³Ø§Ø³ÛŒ Ø¯Ø± Ø´Ù…Ø§ Ø¬ÙˆØ´ÛŒØ¯ØŸ\",\n","    \"Ø§ÛŒÙ† Ø­Ø±Ù Ø´Ù…Ø§ Ù…Ø±Ø§ Ø¨Ù‡ ÙÚ©Ø± ÙØ±Ùˆ Ø¨Ø±Ø¯...\"\n","]\n","\n","\n","\n","def reflect_and_prompt(user_input: str) -> str:\n","    FAMILY_RULE_TAG = \"#FAMILY_RULE#\"\n","   \n","    for pattern, responses in POETIC_ELIZA_RULES.items():\n","        \n","        # This variable will hold the actual regex pattern without the tag\n","        clean_pattern = pattern\n","        is_family_rule = False\n","\n","        # CHANGE 2: Check for the tag's existence.\n","        if pattern.startswith(FAMILY_RULE_TAG):\n","            is_family_rule = True\n","            # Remove the tag so it doesn't interfere with the regex matching\n","            clean_pattern = pattern.replace(FAMILY_RULE_TAG, \"\")\n","\n","        match = re.search(clean_pattern, user_input, re.IGNORECASE)\n","        \n","        if match:\n","            captured_groups = list(match.groups())\n","            transformed_groups = []\n","            \n","            for i, group_text in enumerate(captured_groups):\n","                # Now we use our reliable boolean flag to check the rule type\n","                if is_family_rule and i == 0:\n","                    # This logic is now guaranteed to run for the correct rule\n","                    base_word = group_text[:-1] if group_text.endswith('Ù…') else group_text\n","                    reflected_word = base_word + 'Øª'\n","                    transformed_groups.append(reflected_word)\n","                    continue\n","\n","                # For all other groups, perform the standard pronoun swap\n","                words = group_text.split()\n","                swapped_words = [PRONOUN_SWAP.get(word, word) for word in words]\n","                transformed_groups.append(\" \".join(swapped_words))\n","\n","            response_template = random.choice(responses)\n","            return response_template.format(*transformed_groups)\n","            \n","    return random.choice(FALLBACK_RESPONSES)\n"]},{"cell_type":"code","execution_count":9,"id":"3502b92b","metadata":{"execution":{"iopub.execute_input":"2025-11-15T19:57:32.666255Z","iopub.status.busy":"2025-11-15T19:57:32.665996Z","iopub.status.idle":"2025-11-15T19:57:32.675548Z","shell.execute_reply":"2025-11-15T19:57:32.674731Z"},"papermill":{"duration":0.014779,"end_time":"2025-11-15T19:57:32.676724","exception":false,"start_time":"2025-11-15T19:57:32.661945","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["--- ğŸ¤– Chatbot Moshare ÙØ¹Ø§Ù„ Ø´Ø¯ ---\n","ÛŒÚ© Ø¨ÛŒØª Ø´Ø¹Ø± Ø¨ÙØ±Ø³ØªÛŒØ¯ ØªØ§ Ø¨Ø§ Ø¨ÛŒØª Ø¨Ø¹Ø¯ÛŒ Ù¾Ø§Ø³Ø® Ø¯Ù‡Ù….\n","Ø§Ú¯Ø± Ù…ÛŒØ®ÙˆØ§Ù‡ÛŒ Ù…Ø´Ø§Ø¹Ø±Ù‡ Ú©Ù†ÛŒÙ… Ù„Ø·ÙØ§ Ø§Ø² Ø¹Ù„Ø§Ø¦Ù… Ù†Ú¯Ø§Ø±Ø´ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù† Ø­ØªÛŒ Ø§Ø² Ù†Ù‚Ø·Ù‡\n","Ø§Ú¯Ø± Ù…ÛŒØ®ÙˆØ§Ù‡ÛŒ ØµØ­Ø¨Øª Ú©Ù†ÛŒÙ… ÛŒØ§Ø¯Øª Ø¨Ø§Ø´Ù‡ Ø¨Ø§ÛŒØ¯ Ø§Ø² Ø¹Ù„Ø§Ø¦Ù… Ù†Ú¯Ø§Ø±Ø´ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒ\n","Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ØŒ Ø¹Ø¨Ø§Ø±Øª 'Ø®Ø±ÙˆØ¬' Ø±Ø§ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯.\n","--------------------\n","\n","Bot: Ú†Ù‡ Ø²ÛŒØ¨Ø§ Ø§Ø² Ù…Ø§Ø¯Ø±Øª ÛŒØ§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯. Ø±Ø§Ø¨Ø·Ù‡â€ŒØªØ§Ù† Ú†Ú¯ÙˆÙ†Ù‡ Ø§Ø³ØªØŸ\n","\n","--------------------\n","\n","Bot: Ú†Ù‡ Ø²ÛŒØ¨Ø§ Ø§Ø² Ù…Ø§Ø¯Ø±Øª ÛŒØ§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯. Ø±Ø§Ø¨Ø·Ù‡â€ŒØªØ§Ù† Ú†Ú¯ÙˆÙ†Ù‡ Ø§Ø³ØªØŸ\n","\n","--------------------\n","\n","Bot: Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¨Ø±Ø§ÛŒØªØ§Ù† Ø´Ø¹Ø±ÛŒ Ø¯Ø± ÙˆØµÙ Ù…Ø§Ø¯Ø±Øª Ø¨Ø®ÙˆØ§Ù†Ù…ØŸ\n","\n","--------------------\n"]}],"source":["POEM_COLUMN_NAME = 'misra1' \n","\n","\n","\n","print(\"--- ğŸ¤– Chatbot Moshare ÙØ¹Ø§Ù„ Ø´Ø¯ ---\")\n","print(\"ÛŒÚ© Ø¨ÛŒØª Ø´Ø¹Ø± Ø¨ÙØ±Ø³ØªÛŒØ¯ ØªØ§ Ø¨Ø§ Ø¨ÛŒØª Ø¨Ø¹Ø¯ÛŒ Ù¾Ø§Ø³Ø® Ø¯Ù‡Ù….\")\n","print(\"Ø§Ú¯Ø± Ù…ÛŒØ®ÙˆØ§Ù‡ÛŒ Ù…Ø´Ø§Ø¹Ø±Ù‡ Ú©Ù†ÛŒÙ… Ù„Ø·ÙØ§ Ø§Ø² Ø¹Ù„Ø§Ø¦Ù… Ù†Ú¯Ø§Ø±Ø´ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù† Ø­ØªÛŒ Ø§Ø² Ù†Ù‚Ø·Ù‡\")\n","print(\"Ø§Ú¯Ø± Ù…ÛŒØ®ÙˆØ§Ù‡ÛŒ ØµØ­Ø¨Øª Ú©Ù†ÛŒÙ… ÛŒØ§Ø¯Øª Ø¨Ø§Ø´Ù‡ Ø¨Ø§ÛŒØ¯ Ø§Ø² Ø¹Ù„Ø§Ø¦Ù… Ù†Ú¯Ø§Ø±Ø´ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒ\")\n","print(\"Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ØŒ Ø¹Ø¨Ø§Ø±Øª 'Ø®Ø±ÙˆØ¬' Ø±Ø§ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯.\")\n","print(\"-\" * 20)\n","\n","n = 0 \n","while (n<3):\n","    try:\n","        user_input = (\"You: Ø¯Ø± ÙˆØµÙ Ù…Ø§Ø¯Ø±Ù… Ø´Ø¹Ø± Ø¨Ù†ÙˆÛŒØ³.\")\n","        n  = n+1\n","        if user_input.strip().lower() in [\"exit\", \"quit\", \"Ø®Ø±ÙˆØ¬\"]:\n","            print(\"Bot: Hope to see you again. Goodbye!\")\n","            break\n","\n","        # Dual-mode logic: Conversation or Moshareh (Poetry Contest)\n","        if \"?\" in user_input or \"!\" in user_input or \".\" in user_input:\n","            # Conversation Mode\n","            \n","            # Priority 1: Handle predefined, specific questions\n","            conversation_reply = handle_conversation(user_input)\n","            \n","            if conversation_reply:\n","                print(f\"\\nBot: {conversation_reply}\\n\")\n","            else:\n","                # Priority 2: If no specific pattern matches, fall back to ELIZA-style reflection\n","                reflection_reply = reflect_and_prompt(user_input)\n","                print(f\"\\nBot: {reflection_reply}\\n\")\n","        \n","        else:\n","            # Moshareh (Poetry Contest) Mode\n","            poet_guess_message = guess_the_poet(user_input)\n","            moshareh_reply = find_reply_poem(user_input, all_poems_df, POEM_COLUMN_NAME)\n","            \n","            print(\"\\nBot:\")\n","            if poet_guess_message:\n","                print(f\"Analysis of your verse: {poet_guess_message}\")\n","            \n","            print(f\"{moshareh_reply}\\n\")\n","        \n","        print(\"-\" * 20)\n","\n","    except (KeyboardInterrupt, EOFError):\n","        print(\"\\nGoodbye!\")\n","        break\n","    except Exception as e:\n","        print(f\"An unexpected error occurred: {e}\")\n","        break"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"datasetId":8682116,"sourceId":13656357,"sourceType":"datasetVersion"},{"datasetId":8682151,"sourceId":13656402,"sourceType":"datasetVersion"}],"dockerImageVersionId":31192,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":7.332986,"end_time":"2025-11-15T19:57:33.097208","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-11-15T19:57:25.764222","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}